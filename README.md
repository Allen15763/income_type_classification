# 稅務扣繳類型自動分類系統

本系統用於自動分類稅務扣繳類型，基於機器學習技術，可幫助會計人員快速處理大量交易資料。

## 功能特點

- 自動分析交易描述和供應商資訊，預測適當的所得稅扣繳類型
- 支援Excel、CSV和Parquet格式的輸入檔案
- 直觀的使用者介面，便於操作和資料檢視
- 批次處理大量交易資料
- 自動產生包含預測結果的報表，便於後續處理

## 系統需求

- Windows 10或更高版本
- 4GB以上記憶體
- 1GB以上硬碟空間

## 安裝方法

### 使用可執行檔安裝

1. 下載最新版本的安裝包
2. 解壓縮至任意目錄
3. 執行`稅務扣繳類型自動分類系統.exe`

### 從原始碼安裝

1. 確保已安裝Python 3.11或更高版本
2. 複製原始碼至本地目錄
3. 安裝相依套件：`pip install -r requirements.txt`
4. 執行應用程式：`python main.py`

## 使用說明

### 初次使用

1. 啟動應用程式後，首先需要設定預訓練模型
2. 點擊「瀏覽...」按鈕選擇模型檔案、編碼器檔案和特徵管道檔案
3. 設定輸入和輸出目錄
4. 點擊「重新載入模型」按鈕載入模型

### 執行預測

1. 點擊「瀏覽檔案」選擇包含待分類交易的檔案（Excel、CSV或Parquet格式）
2. 點擊「預測」按鈕開始處理
3. 處理完成後，結果會顯示在表格中，預測的扣繳類型在「predicted_income_type」欄位
4. 點擊「儲存結果」將處理後的資料儲存為所選格式

## 檔案格式要求

輸入檔案需包含以下欄位（部分欄位可為空）：

- Payment Date (付款日期)
- Remit-to Supplier (供應商名稱)
- Supplier ID (供應商統一編號)
- Line Desc (交易描述)
- Line Amount (金額)
- Income Type (所得類型)
- W/H Tax (扣繳稅率)
- W/H Tax Name (扣繳稅率名稱)
- Income Type Name (所得類型名稱)

## 故障排除

### 常見問題

1. **無法載入模型**
   - 確認模型檔案路徑正確
   - 確認使用的是相容的模型版本

2. **預測錯誤**
   - 確認輸入檔案格式正確
   - 確認檔案包含所需欄位

3. **應用程式無回應**
   - 處理大量資料時可能需要較長時間
   - 檢查系統資源使用情況

### 日誌檔案

系統日誌位於使用者目錄下的`WithholdingTaxClassifier/logs/`目錄，可用於診斷問題。

## 開發資訊

### 架構概述

本系統採用SOLID設計原則，主要模組包括：

- **核心模組**：資料處理、特徵工程、模型管理、預測引擎
- **使用者介面**：主視窗、資料呈現、互動控件
- **工具模組**：日誌記錄、配置管理、資料驗證

### 打包應用程式

使用PyInstaller打包應用程式為可執行檔：

```
python build.py
```

生成的可執行檔將位於`dist/稅務扣繳類型自動分類系統/`目錄中。

## 授權

本軟體僅供內部使用，未經授權不得分發。

## 聯絡方式

如有任何問題或建議，請聯絡系統管理員。